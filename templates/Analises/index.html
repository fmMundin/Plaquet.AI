{% extends "base.html" %}
{% load static %}

{% block title %}Plaquet.AI - Início{% endblock %}

{% block content %}
<div class="container mt-4" id="features">
    <div class="row align-items-center">
        <div class="col-lg-5">
            <div class="card welcome-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="mb-4">
                        <h1 class="card-title text-contrast">Bem-vindo ao Plaquet.AI</h1>
                        <p class="text-muted mt-3">Sistema de análise de células sanguíneas com Inteligência Artificial
                        </p>
                    </div>

                    <div class="welcome-features">
                        <div class="feature-item">
                            <i class="fas fa-bolt text-primary"></i>
                            <div>
                                <h5>Processamento Rápido</h5>
                                <p>Resultados em menos de 10 segundos</p>
                            </div>
                        </div>

                        <div class="feature-item">
                            <i class="fas fa-crosshairs text-success"></i>
                            <div>
                                <h5>Alta Precisão</h5>
                                <p>Detecção precisa com IA avançada</p>
                            </div>
                        </div>

                        <div class="feature-item">
                            <i class="fas fa-chart-bar text-info"></i>
                            <div>
                                <h5>Análise Detalhada</h5>
                                <p>Contagem e classificação automática</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-auto">
                        <a href="{% url 'Analises:analises' %}" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-microscope me-2"></i>Começar Análise
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-7">
            <div class="card h-100">
                <div class="card-body p-0">
                    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
                            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
                            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
                        </div>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img src="/media/geral/hero2.png" class="d-block w-100" alt="Análise de Plaquetas">
                                <div class="carousel-caption d-none d-md-block">
                                    <h3>Análise de Células</h3>
                                    <p>Detecção precisa com IA</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="/media/geral/hero3.png" class="d-block w-100" alt="Células Brancas">
                                <div class="carousel-caption d-none d-md-block">
                                    <h3>Células Brancas</h3>
                                    <p>Identificação automática</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="/media/geral/hero4.png" class="d-block w-100" alt="Células Vermelhas">
                                <div class="carousel-caption d-none d-md-block">
                                    <h3>Células Vermelhas</h3>
                                    <p>Contagem precisa</p>
                                </div>
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon"></span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card mt-5">
        <div class="card-body">
            <h2 class="text-contrast mb-4">Amostras Interativas</h2>
            <div class="samples-carousel">
                <div class="samples-track" id="samplesTrack">
                    <div class="sample-slide active">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original1.png' %}" alt="Plaquetas" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected1.png' %}" alt="Detecção"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">Plaquetas <span class="badge bg-primary">Platelets</span></p>
                    </div>

                    <div class="sample-slide">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original2.png' %}" alt="WBC" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected2.png' %}" alt="Detecção"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">Células Brancas <span class="badge bg-success">WBC</span></p>
                    </div>

                    <div class="sample-slide">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original3.png' %}" alt="RBC" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected3.jpg' %}" alt="Detecção"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">Células Vermelhas <span class="badge bg-danger">RBC</span></p>
                    </div>
                </div>

                <div class="samples-controls">
                    <button class="prev" id="samplesPrevBtn"><i class="fas fa-chevron-left"></i></button>
                    <button class="next" id="samplesNextBtn"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>

            <p class="text-muted mt-3 text-center">
                <i class="fas fa-info-circle me-2"></i>
                Passe o mouse sobre as imagens para ver as detecções realizadas pela IA
            </p>
        </div>
    </div>

    <div class="card mt-5">
        <div class="card-body">
            <h2 class="text-contrast mb-4">
                <i class="fas fa-quote-left me-2 text-primary"></i>
                Depoimentos
            </h2>
            <div id="depoimentosCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <div class="testimonial-card">
                            <div class="testimonial-content">
                                <div class="testimonial-text">
                                    <i class="fas fa-quote-right text-primary float-end ms-2"></i>
                                    <p class="lead mb-0">Parabéns pelo projeto! Muito bem feito e de grande relevância!</p>
                                </div>
                                <div class="testimonial-author mt-4">
                                    <div class="author-avatar">
                                        <i class="fas fa-user-circle fa-2x text-primary"></i>
                                    </div>
                                    <div class="author-info">
                                        <h5 class="mb-1">Adriana Coelho</h5>
                                        <p class="text-muted mb-0">Feira Bentotec - ETEC Bento Quirino</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <div class="testimonial-card">
                            <div class="testimonial-content">
                                <div class="testimonial-text">
                                    <i class="fas fa-quote-right text-primary float-end ms-2"></i>
                                    <p class="lead mb-0">Maravilhoso! Presença pertinente da pesquisa para auxiliar as pessoas que não tem acesso rápido a um hemograma!</p>
                                </div>
                                <div class="testimonial-author mt-4">
                                    <div class="author-avatar">
                                        <i class="fas fa-user-circle fa-2x text-primary"></i>
                                    </div>
                                    <div class="author-info">
                                        <h5 class="mb-1">Rita Carvalho</h5>
                                        <p class="text-muted mb-0">Feira Bragantec - IFSP Bragança Paulista</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#depoimentosCarousel" data-bs-slide="prev">
                    <i class="fas fa-chevron-left text-primary"></i>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#depoimentosCarousel" data-bs-slide="next">
                    <i class="fas fa-chevron-right text-primary"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="card mt-5">
        <div class="card-body">
            <h2 class="text-contrast mb-4">Perguntas Frequentes</h2>
            <div class="faq-container">
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        Como funciona o Plaquet.AI?
                        <i class="fas fa-plus"></i>
                    </div>
                    <div class="faq-answer">
                        O Plaquet.AI utiliza algoritmos de IA para analisar imagens microscópicas e realizar a contagem
                        precisa de células.
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        Qual a precisão do sistema?
                        <i class="fas fa-plus"></i>
                    </div>
                    <div class="faq-answer">
                        O sistema precisa passar por uma melhora na prrecisão, mas no momento, o sistema tem uma acurácia média de 82%.
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        Quais tipos de células são detectadas?
                        <i class="fas fa-plus"></i>
                    </div>
                    <div class="faq-answer">
                        O sistema detecta três tipos principais de células: plaquetas (PLT), células brancas (WBC) e células vermelhas (RBC).
                    </div>
                </div>
            </div>
        </div>
    </div>

<button class="theme-switch" onclick="toggleTheme()" data-bs-toggle="tooltip" data-bs-placement="left"
    title="Alternar tema claro/escuro">
    <i class="fas fa-moon"></i>
</button>
{% endblock %}

{% block css %}
<style>
.hero-image-1 {
    background-image: url("/media/geral/hero2.png");
}
.hero-image-2 {
    background-image: url("/media/geral/hero3.png");
}
.hero-image-3 {
    background-image: url("/media/geral/hero4.png");
}

.hero-image-1 {
    background-image: url("{{ MEDIA_URL }}geral/hero2.png");
}
.hero-image-2 {
    background-image: url("{{ MEDIA_URL }}geral/hero3.png");
}
.hero-image-3 {
    background-image: url("{{ MEDIA_URL }}geral/hero4.png");
}

.carousel-item img {
    width: 100%;
    height: 400px;
    object-fit: cover;
    border-radius: 8px;
}

.carousel-caption {
    background: rgba(0, 0, 0, 0.7);
    border-radius: 8px;
    padding: 20px;
    bottom: 20px;
}

.carousel-indicators {
    bottom: -10px;
}

.carousel-control-prev,
.carousel-control-next {
    width: 5%;
}

@media (max-width: 768px) {
    .carousel-item img {
        height: 300px;
    }
    
    .carousel-caption {
        padding: 10px;
    }
    
    .carousel-caption h3 {
        font-size: 1.2rem;
    }
    
    .carousel-caption p {
        font-size: 0.9rem;
    }
}

.testimonial-card {
    padding: 2rem;
    border-radius: 1rem;
    background: linear-gradient(145deg, #ffffff, #f8f9fa);
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    transition: all 0.3s ease;
}

.testimonial-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.testimonial-content {
    position: relative;
    padding: 1rem;
}

.testimonial-text {
    position: relative;
    margin-bottom: 2rem;
}

.testimonial-author {
    display: flex;
    align-items: center;
    gap: 1rem;
    border-top: 1px solid rgba(0,0,0,0.05);
    padding-top: 1.5rem;
}

.author-avatar {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(13, 110, 253, 0.1);
    border-radius: 50%;
}

.carousel-control-prev,
.carousel-control-next {
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 50%;
    opacity: 1;
    top: 50%;
    transform: translateY(-50%);
}

.carousel-control-prev {
    left: -20px;
}

.carousel-control-next {
    right: -20px;
}

.carousel-control-prev-icon,
.carousel-control-next-icon {
    display: none;
}

#depoimentosCarousel .fas {
    font-size: 1.2rem;
}

@media (max-width: 768px) {
    .testimonial-card {
        padding: 1rem;
    }
    
    .carousel-control-prev,
    .carousel-control-next {
        display: none;
    }
}

#heroCarousel {
    border-radius: 8px;
    overflow: hidden;
}

#heroCarousel .carousel-item {
    height: 400px;
}

#heroCarousel .carousel-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

#heroCarousel .carousel-caption {
    background: rgba(0, 0, 0, 0.5);
    border-radius: 8px;
    padding: 20px;
}

@media (max-width: 768px) {
    #heroCarousel .carousel-item {
        height: 300px;
    }
}
</style>
{% endblock %}

{% block js %}
{{ block.super }}
<script>
    function toggleTheme() {
        const root = document.documentElement;
        const currentTheme = root.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        root.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);

        const icon = document.querySelector('.theme-switch i');
        icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    }

    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });

        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        const icon = document.querySelector('.theme-switch i');
        if (icon) {
            icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }
    });

    document.addEventListener('DOMContentLoaded', function () {
        const heroCarousel = document.getElementById('heroCarousel');
        const slides = heroCarousel.querySelectorAll('.hero-slide');
        const prevBtn = heroCarousel.querySelector('.hero-prev');
        const nextBtn = heroCarousel.querySelector('.hero-next');
        const indicators = heroCarousel.querySelector('.hero-indicators');
        let currentSlide = 0;

        slides.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.classList.add('hero-indicator');
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => goToSlide(index));
            indicators.appendChild(dot);
        });

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                indicators.children[index].classList.remove('active');
                slide.classList.add(index === currentSlide ? 'active' : 'inactive');
                indicators.children[index].classList.add(index === currentSlide ? 'active' : '');
            });
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlides();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            updateSlides();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            updateSlides();
        }

        function startAutoplay() {
            stopAutoplay();
            autoplayInterval = setInterval(nextSlide, 5000);
        }

        function stopAutoplay() {
            if (autoplayInterval) {
                clearInterval(autoplayInterval);
            }
        }

        prevBtn.addEventListener('click', prevSlide);
        nextBtn.addEventListener('click', nextSlide);

        heroCarousel.addEventListener('mouseenter', stopAutoplay);
        heroCarousel.addEventListener('mouseleave', startAutoplay);

        startAutoplay();
        updateSlides();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const track = document.getElementById('samplesTrack');
        const slides = track.querySelectorAll('.sample-slide');
        const prevBtn = document.getElementById('samplesPrevBtn');
        const nextBtn = document.getElementById('samplesNextBtn');
        let currentIndex = 0;
        const totalSlides = slides.length;

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev', 'next');

                if (index === currentIndex) {
                    slide.classList.add('active');
                } else if (index === ((currentIndex - 1 + totalSlides) % totalSlides)) {
                    slide.classList.add('prev');
                } else if (index === ((currentIndex + 1) % totalSlides)) {
                    slide.classList.add('next');
                }
            });
        }

        function moveSlide(direction) {
            if (direction === 'next') {
                currentIndex = (currentIndex + 1) % totalSlides;
            } else {
                currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
            }
            updateSlides();
        }

        prevBtn.addEventListener('click', () => {
            moveSlide('prev');
        });

        nextBtn.addEventListener('click', () => {
            moveSlide('next');
        });

        slides.forEach(slide => {
            const container = slide.querySelector('.sample-image-container');
            const overlay = slide.querySelector('.sample-overlay');

            container.addEventListener('mousemove', function (e) {
                if (!slide.classList.contains('active')) return;
                const rect = container.getBoundingClientRect();
                const x = (e.clientX - rect.left) / rect.width;
                overlay.style.clipPath = `inset(0 ${(1 - x) * 100}% 0 0)`;
            });

            container.addEventListener('mouseleave', function () {
                if (!slide.classList.contains('active')) return;
                overlay.style.clipPath = 'inset(0 100% 0 0)';
            });
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowLeft') moveSlide('prev');
            if (e.key === 'ArrowRight') moveSlide('next');
        });

        updateSlides();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const heroCarousel = document.getElementById('heroCarousel');
        const slides = heroCarousel.querySelectorAll('.hero-slide');
        const prevBtn = heroCarousel.querySelector('.hero-prev');
        const nextBtn = heroCarousel.querySelector('.hero-next');
        const indicators = heroCarousel.querySelector('.hero-indicators');
        let currentSlide = 0;
        let autoplayInterval;

        slides.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.classList.add('hero-indicator');
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => {
                stopAutoplay();
                goToSlide(index);
                startAutoplay();
            });
            indicators.appendChild(dot);
        });

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev', 'next');
                indicators.children[index].classList.remove('active');

                if (index === currentSlide) {
                    slide.classList.add('active');
                    indicators.children[index].classList.add('active');
                } else if (index === (currentSlide - 1 + slides.length) % slides.length) {
                    slide.classList.add('prev');
                } else if (index === (currentSlide + 1) % slides.length) {
                    slide.classList.add('next');
                }
            });
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlides();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            updateSlides();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            updateSlides();
        }

        function startAutoplay() {
            stopAutoplay();
            autoplayInterval = setInterval(nextSlide, 5000);
        }

        function stopAutoplay() {
            if (autoplayInterval) {
                clearInterval(autoplayInterval);
            }
        }

        prevBtn.addEventListener('click', () => {
            stopAutoplay();
            prevSlide();
            startAutoplay();
        });

        nextBtn.addEventListener('click', () => {
            stopAutoplay();
            nextSlide();
            startAutoplay();
        });

        heroCarousel.addEventListener('mouseenter', stopAutoplay);
        heroCarousel.addEventListener('mouseleave', startAutoplay);

        startAutoplay();
        updateSlides();
    });

    function toggleFaq(element) {
        const faqItem = element.parentElement;
        const icon = element.querySelector('i');
        const answer = faqItem.querySelector('.faq-answer');
        
        document.querySelectorAll('.faq-item').forEach(item => {
            if (item !== faqItem && item.classList.contains('active')) {
                item.classList.remove('active');
                item.querySelector('i').classList.remove('fa-minus');
                item.querySelector('i').classList.add('fa-plus');
            }
        });
        
        faqItem.classList.toggle('active');
        if (faqItem.classList.contains('active')) {
            icon.classList.remove('fa-plus');
            icon.classList.add('fa-minus');
        } else {
            icon.classList.remove('fa-minus');
            icon.classList.add('fa-plus');
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        new bootstrap.Carousel(document.querySelector('#heroCarousel'), {
            interval: 5000,
            wrap: true,
            keyboard: true
        });
    });
</script>
{% endblock %}