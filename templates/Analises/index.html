{% extends "base.html" %}
{% load static %}

{% block title %}Plaquet.AI - In√≠cio{% endblock %}

{% block content %}
<!-- Layout de duas colunas -->
<div class="container mt-4" id="features">
    <div class="row align-items-center">
        <!-- Coluna Esquerda - Card de Boas-vindas -->
        <div class="col-lg-5">
            <div class="card welcome-card h-100">
                <div class="card-body d-flex flex-column">
                    <div class="mb-4">
                        <h1 class="card-title text-contrast">Bem-vindo ao Plaquet.AI</h1>
                        <p class="text-muted mt-3">Sistema de an√°lise de c√©lulas sangu√≠neas com Intelig√™ncia Artificial
                        </p>
                    </div>

                    <div class="welcome-features">
                        <div class="feature-item">
                            <i class="fas fa-bolt text-primary"></i>
                            <div>
                                <h5>Processamento R√°pido</h5>
                                <p>Resultados em menos de 1 segundo</p>
                            </div>
                        </div>

                        <div class="feature-item">
                            <i class="fas fa-crosshairs text-success"></i>
                            <div>
                                <h5>Alta Precis√£o</h5>
                                <p>Detec√ß√£o precisa com IA avan√ßada</p>
                            </div>
                        </div>

                        <div class="feature-item">
                            <i class="fas fa-chart-bar text-info"></i>
                            <div>
                                <h5>An√°lise Detalhada</h5>
                                <p>Contagem e classifica√ß√£o autom√°tica</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-auto">
                        <a href="{% url 'analises' %}" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-microscope me-2"></i>Come√ßar An√°lise
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coluna Direita - Hero Carousel -->
        <div class="col-lg-7">
            <div class="card h-100"> <!-- Adicionado h-100 para manter altura igual ao card da esquerda -->
                <div class="card-body p-0">
                    <div class="hero-carousel" id="heroCarousel">
                        <div class="hero-slide active">
                            <div class="hero-image hero-image-1">
                                <div class="hero-content">
                                    <h3>An√°lise de Plaquetas</h3>
                                    <p>Detec√ß√£o precisa com IA</p>
                                </div>
                            </div>
                        </div>
                        <div class="hero-slide">
                            <div class="hero-image hero-image-2">
                                <div class="hero-content">
                                    <h3>C√©lulas Brancas</h3>
                                    <p>Identifica√ß√£o autom√°tica</p>
                                </div>
                            </div>
                        </div>
                        <div class="hero-slide">
                            <div class="hero-image hero-image-3">
                                <div class="hero-content">
                                    <h3>C√©lulas Vermelhas</h3>
                                    <p>Contagem precisa</p>
                                </div>
                            </div>
                        </div>
                        <div class="hero-controls">
                            <button class="hero-prev"><i class="fas fa-chevron-left"></i></button>
                            <div class="hero-indicators"></div>
                            <button class="hero-next"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Atualizar a se√ß√£o do carrossel de amostras -->
    <div class="card mt-5">
        <div class="card-body">
            <h2 class="text-contrast mb-4">Amostras Interativas</h2>
            <div class="samples-carousel">
                <div class="samples-track" id="samplesTrack">
                    <!-- Plaquetas -->
                    <div class="sample-slide active">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original1.png' %}" alt="Plaquetas" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected1.png' %}" alt="Detec√ß√£o"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">Plaquetas <span class="badge bg-primary">Platelets</span></p>
                    </div>

                    <!-- C√©lulas Brancas -->
                    <div class="sample-slide">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original2.png' %}" alt="WBC" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected2.png' %}" alt="Detec√ß√£o"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">C√©lulas Brancas <span class="badge bg-success">WBC</span></p>
                    </div>

                    <!-- C√©lulas Vermelhas -->
                    <div class="sample-slide">
                        <div class="sample-image-container">
                            <img src="{% static 'images/original3.png' %}" alt="RBC" class="sample-base-image">
                            <div class="sample-overlay">
                                <img src="{% static 'images/detected3.jpg' %}" alt="Detec√ß√£o"
                                    class="sample-overlay-image">
                            </div>
                        </div>
                        <p class="text-center mt-2">C√©lulas Vermelhas <span class="badge bg-danger">RBC</span></p>
                    </div>
                </div>

                <div class="samples-controls">
                    <button class="prev" id="samplesPrevBtn"><i class="fas fa-chevron-left"></i></button>
                    <button class="next" id="samplesNextBtn"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>

            <p class="text-muted mt-3 text-center">
                <i class="fas fa-info-circle me-2"></i>
                Passe o mouse sobre as imagens para ver as detec√ß√µes realizadas pela IA
            </p>
        </div>
    </div>

    <!-- Cards do Projeto -->
    <div class="row g-4 mt-5">
        <div class="col-md-4">
            <div class="feature-card h-100">
                <div class="feature-icon">‚ö°</div>
                <h3 class="feature-title">Processamento R√°pido</h3>
                <p class="feature-text">Resultados em menos de 1 segundo, otimizando o fluxo de trabalho laboratorial.
                </p>
            </div>
        </div>

        <div class="col-md-4">
            <div class="feature-card h-100">
                <div class="feature-icon">üéØ</div>
                <h3 class="feature-title">Alta Precis√£o</h3>
                <p class="feature-text">Detec√ß√£o precisa de c√©lulas utilizando modelos de IA avan√ßados.</p>
            </div>
        </div>

        <div class="col-md-4">
            <div class="feature-card h-100">
                <div class="feature-icon">üìä</div>
                <h3 class="feature-title">An√°lise Detalhada</h3>
                <p class="feature-text">Contagem autom√°tica e classifica√ß√£o de diferentes tipos de c√©lulas.</p>
            </div>
        </div>
    </div>
</div>

<!-- Bot√£o de tema com tooltip -->
<button class="theme-switch" onclick="toggleTheme()" data-bs-toggle="tooltip" data-bs-placement="left"
    title="Alternar tema claro/escuro">
    <i class="fas fa-moon"></i>
</button>
{% endblock %}

{% block css %}
<style>
.hero-image-1 {
    background-image: url("{% static 'images/hero1.jpg' %}");
}
.hero-image-2 {
    background-image: url("{% static 'images/hero2.jpg' %}");
}
.hero-image-3 {
    background-image: url("{% static 'images/hero3.jpg' %}");
}
</style>
{% endblock %}

{% block js %}
{{ block.super }}
<script>
    function toggleTheme() {
        const root = document.documentElement;
        const currentTheme = root.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        root.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);

        const icon = document.querySelector('.theme-switch i');
        icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    }

    // Inicializar tooltips
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });

        // Inicializar tema
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        const icon = document.querySelector('.theme-switch i');
        if (icon) {
            icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }
    });

    // Adicionar c√≥digo do carousel hero
    document.addEventListener('DOMContentLoaded', function () {
        const heroCarousel = document.getElementById('heroCarousel');
        const slides = heroCarousel.querySelectorAll('.hero-slide');
        const prevBtn = heroCarousel.querySelector('.hero-prev');
        const nextBtn = heroCarousel.querySelector('.hero-next');
        const indicators = heroCarousel.querySelector('.hero-indicators');
        let currentSlide = 0;

        // Criar indicadores
        slides.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.classList.add('hero-indicator');
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => goToSlide(index));
            indicators.appendChild(dot);
        });

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                indicators.children[index].classList.remove('active');
                slide.classList.add(index === currentSlide ? 'active' : 'inactive');
                indicators.children[index].classList.add(index === currentSlide ? 'active' : '');
            });
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlides();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            updateSlides();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            updateSlides();
        }

        function startAutoplay() {
            stopAutoplay();
            autoplayInterval = setInterval(nextSlide, 5000);
        }

        function stopAutoplay() {
            if (autoplayInterval) {
                clearInterval(autoplayInterval);
            }
        }

        // Event listeners
        prevBtn.addEventListener('click', prevSlide);
        nextBtn.addEventListener('click', nextSlide);

        // Pausar autoplay quando o mouse estiver sobre o carrossel
        heroCarousel.addEventListener('mouseenter', stopAutoplay);
        heroCarousel.addEventListener('mouseleave', startAutoplay);

        // Iniciar autoplay
        startAutoplay();
        updateSlides();
    });

    // Samples Carousel
    document.addEventListener('DOMContentLoaded', function () {
        const track = document.getElementById('samplesTrack');
        const slides = track.querySelectorAll('.sample-slide');
        const prevBtn = document.getElementById('samplesPrevBtn');
        const nextBtn = document.getElementById('samplesNextBtn');
        let currentIndex = 0;
        const totalSlides = slides.length;

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev', 'next');

                if (index === currentIndex) {
                    slide.classList.add('active');
                } else if (index === ((currentIndex - 1 + totalSlides) % totalSlides)) {
                    slide.classList.add('prev');
                } else if (index === ((currentIndex + 1) % totalSlides)) {
                    slide.classList.add('next');
                }
            });
        }

        function moveSlide(direction) {
            if (direction === 'next') {
                currentIndex = (currentIndex + 1) % totalSlides;
            } else {
                currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
            }
            updateSlides();
        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            moveSlide('prev');
        });

        nextBtn.addEventListener('click', () => {
            moveSlide('next');
        });

        // Hover effect apenas para slide ativo
        slides.forEach(slide => {
            const container = slide.querySelector('.sample-image-container');
            const overlay = slide.querySelector('.sample-overlay');

            container.addEventListener('mousemove', function (e) {
                if (!slide.classList.contains('active')) return;
                const rect = container.getBoundingClientRect();
                const x = (e.clientX - rect.left) / rect.width;
                overlay.style.clipPath = `inset(0 ${(1 - x) * 100}% 0 0)`;
            });

            container.addEventListener('mouseleave', function () {
                if (!slide.classList.contains('active')) return;
                overlay.style.clipPath = 'inset(0 100% 0 0)';
            });
        });

        // Keyboard navigation
        document.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowLeft') moveSlide('prev');
            if (e.key === 'ArrowRight') moveSlide('next');
        });

        // Initial setup
        updateSlides();
    });

    // Hero Carousel
    document.addEventListener('DOMContentLoaded', function() {
        const heroCarousel = document.getElementById('heroCarousel');
        const slides = heroCarousel.querySelectorAll('.hero-slide');
        const prevBtn = heroCarousel.querySelector('.hero-prev');
        const nextBtn = heroCarousel.querySelector('.hero-next');
        const indicators = heroCarousel.querySelector('.hero-indicators');
        let currentSlide = 0;
        let autoplayInterval;

        // Criar indicadores
        slides.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.classList.add('hero-indicator');
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => {
                stopAutoplay();
                goToSlide(index);
                startAutoplay();
            });
            indicators.appendChild(dot);
        });

        function updateSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev', 'next');
                indicators.children[index].classList.remove('active');

                if (index === currentSlide) {
                    slide.classList.add('active');
                    indicators.children[index].classList.add('active');
                } else if (index === (currentSlide - 1 + slides.length) % slides.length) {
                    slide.classList.add('prev');
                } else if (index === (currentSlide + 1) % slides.length) {
                    slide.classList.add('next');
                }
            });
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlides();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            updateSlides();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            updateSlides();
        }

        function startAutoplay() {
            stopAutoplay();
            autoplayInterval = setInterval(nextSlide, 5000);
        }

        function stopAutoplay() {
            if (autoplayInterval) {
                clearInterval(autoplayInterval);
            }
        }

        // Event listeners
        prevBtn.addEventListener('click', () => {
            stopAutoplay();
            prevSlide();
            startAutoplay();
        });

        nextBtn.addEventListener('click', () => {
            stopAutoplay();
            nextSlide();
            startAutoplay();
        });

        // Pausar autoplay quando o mouse estiver sobre o carrossel
        heroCarousel.addEventListener('mouseenter', stopAutoplay);
        heroCarousel.addEventListener('mouseleave', startAutoplay);

        // Iniciar autoplay
        startAutoplay();
        updateSlides();
    });
</script>
{% endblock %}